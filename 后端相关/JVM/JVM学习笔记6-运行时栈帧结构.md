[TOC]

摘自《深入理解Java虚拟机》第二版

# 运行时栈帧结构

**栈帧**（Stack Frame）是用于支持虚拟机进行方法调用和放你发执行的数据结构，它是虚拟机运行时数据区中虚拟机栈的栈元素。

栈帧存储了方法的**局部变量表**、**操作数栈**、**动态连接**和**方法返回地址**等信息。每一个方法从调用到方法的执行的完成对应着一个栈帧在虚拟机栈中从入栈到处栈的过程。

在编译时，栈帧需要多大的局部变量表，多深的操作数栈都已经完全确定了，因此一个栈帧需要分配多少内存，不会受到程序运行期变量数据的影响，而仅仅取决于具体的虚拟机实现。

一个线程中方法调用链可能很长，但只有位于栈顶的栈帧才是有效的，称为**当前栈帧**（Current stack frame），与这个栈帧相关联的方法称为当前方法（Current method），执行引擎运行的所有字节码指令，都只针对当前栈帧进行操作。

## 1 局部变量表

局部变量表（Loacal Variable Table）是一组变量值存储空间，用于存放方法参数和方法内部定义的局部变量。

虚拟机通过**索引定位**的方式使用局部变量表。



















