[TOC]

# sed命令

sed编辑器逐行处理输入，然后把结果发送到屏幕。

-i 选项：直接作用源文件，源文件将被修改。

| 选项 | 说明                                               |
| ---- | -------------------------------------------------- |
| a\   | 在当前行后添加一行或多行                           |
| c\   | 用新文本替换当前行中的文本                         |
| d    | 删除行                                             |
| i\   | 在当前行之前插入文本                               |
| h    | 把模式空间的内容复制到暂存缓冲区                   |
| H    | 把模式空间的内容添加到缓冲区                       |
| g    | 取出暂存缓冲区的内容，将其复制到模式缓冲区         |
| G    | 取出暂存缓冲区的内容，将其追加到模式缓冲区         |
| l    | 列出非打印字符                                     |
| p    | 打印行                                             |
| n    | 读入下一行输入，并从下一条而不是第一条命令对其处理 |
| q    | 结束或退出sed                                      |
| r    | 从文件中读取输入行                                 |
| !    | 对所选行以外的行应用所有命令                       |
| s    | 用一个字符串替换另外一个字符串                     |

## 举例

### 1 打印-p

| 命令                  | 说明                                                  |
| --------------------- | ----------------------------------------------------- |
| sed ‘/abc/p’ file     | 打印file中包含abc的行                                 |
| sed  -n ‘/abc/p’ file | 和上面一样，只是去掉了sed的默认行为，只会打印匹配的行 |

### 2 删除-d

| 命令            | 说明                                             |
| --------------- | ------------------------------------------------ |
| sed ‘3,$d’ file | 删除从第3行到最后一行的内容。<br />$代表最后一行 |
| sed ‘$d’ file   | 删除最后一行的内容                               |
| sed ‘/abc/d’    | 删除包含abc的行。                                |
| sed ‘3d’ file   | 删除第三行的内容                                 |

### 3 替换-s

| 命令                        | 说明                                                         |
| --------------------------- | ------------------------------------------------------------ |
| sed  ‘s/abc/def/’ file      | 把行内的第一个abc替换成def                                   |
| sed  ‘s/abc/def/g’ file     | 把行内的所有abc替换成def                                     |
| sed  -n ‘s/abc/def/p’ file  | 只打印发生替换的那些行                                       |
| sed  ‘s/abc/&def/’ file     | 在所有的abc后面添加def（&表示匹配的内容即abc）               |
| sed  -n ‘s/abc/def/gp’ file | 把所有的abc替换成def，并打印发生替换的那些行                 |
| sed  ‘s#abc#def#g’ file     | 把所有的abc替换成def，<br />跟在替换s后面的字符就是查找串和替换串之间的分割字符<br />本例中为# |

### 4 指定行的范围-,

| 命令                        | 说明                                           |
| --------------------------- | ---------------------------------------------- |
| sed  -n ‘/abc/,/def/p’ file | 打印模式abc到def的行                           |
| sed  -n ‘5/,/def/p’ file    | 打印从第五行到包含def行之间的行。              |
| sed /abd/,/def/s/aaa/bbb/g  | 修改从模式abc到模式def之间的行，把aaa替换成def |

### 5 多重编辑-e

| 命令                                 | 说明                                  |
| ------------------------------------ | ------------------------------------- |
| sed  -e ‘1,3d’ -e ‘s/abc/def/g’ file | 删除1-3行，然后把其余行的abc替换成def |

### 6 读文件-r

| 命令                       | 说明                             |
| -------------------------- | -------------------------------- |
| sed  ‘/abc/r newfile’ file | 在包含abc的行后读入newfile的内容 |

### 7 写文件-w

| 命令                       | 说明                     |
| -------------------------- | ------------------------ |
| sed  ‘/abc/w newfile’ file | 在包含abc的行写入newfile |

### 8 追加-a

| 命令                   | 说明                             |
| ---------------------- | -------------------------------- |
| sed  ‘/abc/a\def’ file | 在包含abc的行后新起一行，写入def |

### 9 插入-i

| 命令                   | 说明                             |
| ---------------------- | -------------------------------- |
| sed  ‘/abc/i\def’ file | 在包含abc的行前新起一行，写入def |

### 10 修改-c

| 命令                   | 说明                                 |
| ---------------------- | ------------------------------------ |
| sed  ‘/abc/c\def’ file | 在包含abc的行替换成def，旧文本被覆盖 |

### 11 读取下一行-n

| 命令                                | 说明                                  |
| ----------------------------------- | ------------------------------------- |
| sed  ‘/abc/{n ; s/aaa/bbb/g;}’ file | 读取包含abc的行的下一行，替换aaa为bbb |

### 12 转换-y

| 命令                  | 说明                                                       |
| --------------------- | ---------------------------------------------------------- |
| sed  ‘y/abc/ABC’ file | 将a替换成A，b替换成B，c替换成C（正则表达式元字符不起作用） |

### 13 退出-q

| 命令                                | 说明                                           |
| ----------------------------------- | ---------------------------------------------- |
| sed  ‘/abc/{ s/aaa/bbb/ ;q; }’ file | 在某行包含了abc，把aaa替换成bbb，然后退出sed。 |