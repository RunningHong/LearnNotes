# Git内部原理

从根本上来讲 Git 是一个内容寻址（content-addressable）文件系统，并在此之上提供了一个版本控制系统的用户界面。

## 1 底层命令和高层命令

Git 最初是一套面向版本控制系统的工具集，而不是一个完整的、用户友好的版本控制系统，所以它还包含了一部分用于完成底层工作的命令。 这些命令被设计成能以 UNIX 命令行的风格连接在一起，抑或藉由脚本调用，来完成工作。 这部分命令一般被称作**“底层（plumbing）”命令**，而那些更友好的命令则被称作**“高层（porcelain）”命令**。

所以**底层命令**即Git的内部工作机制，**高层命令**（便于使用、面向用户）是对底层命令的封装。

## 2 git init

当在一个新目录或已有目录执行 `git init` 时，Git 会创建一个 `.git` 目录。 这个目录包含了几乎所有 Git 存储和操作的对象。

**创建目的**：通过这些文件以及目录记录文件的修改，即把与`.git`文件在同一个目录下的所有文件进行管理，也可以理解为`.git`就是一个记录着版本变化的数据库，从而达到版本控制的效果。

.git包含的主要文件夹：

```java
hooks/         // 包含客户端或服务端的钩子脚本（hook scripts）
info/          // 目录包含一个全局性排除（global exclude）文件
logs/
objects/
refs/
HEAD
description    // 仅供 GitWeb 程序使用
config         // 包含项目特有的配置选项
```

**重要部分**：

-  `objects` 目录存储所有数据内容；
- `refs` 目录存储指向数据（分支）的提交对象的指针；
- `HEAD` 文件指示目前被检出的分支；
- `index` 文件保存暂存区信息。

## 3 Git对象

[Git对象]: https://git-scm.com/book/zh/v2/Git-%E5%86%85%E9%83%A8%E5%8E%9F%E7%90%86-Git-%E5%AF%B9%E8%B1%A1	"Git对象"

Git 是一个内容寻址文件系统。Git 的核心部分是一个简单的键值对数据库（key-value data store）。我们可以向该数据库插入任意类型的内容，它会返回一个键值，通过该键值可以在任意时刻再次检索（retrieve）该内容。 可以通过底层命令 `hash-object` 来演示上述效果——该命令可将任意数据保存于 `.git` 目录，并返回相应的键值。 



















